(()=>{"use strict";var t={d:(e,n)=>{for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};t.d({},{QC:()=>K});var e=document.querySelector("#cardOpened"),n=document.querySelector("#imageClose");function o(t){t.classList.add("popup_opened"),document.addEventListener("keydown",c)}function r(t){t.classList.remove("popup_opened"),document.addEventListener("keydown",c)}function c(t){"Escape"===t.key&&r(document.querySelector(".popup_opened"))}document.querySelectorAll(".popup").forEach((function(t){t.addEventListener("click",(function(e){e.target.classList.contains("popup")&&r(t)}))})),n.addEventListener("click",(function(){r(e)}));var u="34f1d1b4-ec71-416c-890a-2a395d08a4e1",a="https://nomoreparties.co/v1/plus-cohort-12";function i(){return fetch("".concat(a,"/users/me"),{headers:{authorization:u}}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}))}var s=document.querySelector("#cardMesto").content,l=document.querySelector(".cards"),d=document.querySelector(".popup__image"),f=document.querySelector(".popup__image-text"),m="ff2fd85333c77140782d01f0";function p(t,n,c,i,l){var p=s.cloneNode(!0),y=p.querySelector(".card__like-button"),_=p.querySelector(".card__like-counter"),S=p.querySelector(".card__text"),b=p.querySelector(".card__mask-group");return b.src=t,b.alt=n,S.textContent=n,_.textContent=c.length,function(t){var e=!1;return t.forEach((function(t){t._id===m&&(e=!0)})),e}(c)&&y.classList.add("card__like-button_active"),y.addEventListener("click",(function(){!function(t,e,n){n.classList.contains("card__like-button_active")?function(t){return fetch("".concat(a,"/cards/likes/").concat(t),{method:"DELETE",headers:{authorization:u,"Content-Type":"application/json"}}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}))}(t).then((function(t){e.textContent=t.likes.length,n.classList.remove("card__like-button_active")})).catch((function(t){console.log(t)})):function(t){return fetch("".concat(a,"/cards/likes/").concat(t),{method:"PUT",headers:{authorization:u,"Content-Type":"application/json"}}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}))}(t).then((function(t){e.textContent=t.likes.length,n.classList.add("card__like-button_active")})).catch((function(t){console.log(t)}))}(l,_,y)})),i===m?p.querySelector(".card__trash-button").addEventListener("click",(function(){o(K),K.addEventListener("submit",(function(){var t;(t=l,fetch("".concat(a,"/cards/").concat(t),{method:"DELETE",headers:{authorization:u,"Content-Type":"application/json"}}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}))).then((function(){v(),h(),r(K)})).catch((function(t){console.log(t)}))}))})):p.querySelector(".card__trash-button").classList.add("card__trash-button_hidden"),p.querySelector(".card__mask-group").addEventListener("click",(function(r){o(e),d.src=t,f.textContent=n,d.alt=n})),p}function v(){document.querySelectorAll(".card").forEach((function(t){!function(t){t.remove()}(t)}))}function h(){fetch("".concat(a,"/cards"),{headers:{authorization:u}}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).then((function(t){t.forEach((function(t){!function(t,e,n,o,r){var c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"end",u=p(t,e,n,o,r);"start"===c?l.prepend(u):l.append(u)}(t.link,t.name,t.likes,t.owner._id,t._id)}))})).catch((function(t){console.log(t)}))}var y,_,S,b=(S="popup__item_input-error",(_="inputErrorClass")in(y={formSelector:".popup__form",inputSelector:".popup__item",submitButtonSelector:".popup__submit-button",inactiveSubmitButtonClass:"popup__submit-button_inactive",inactiveButtonClass:"popup__button-close",inputErrorClass:"popup__item-error",errorClass:"popup__item-error_active"})?Object.defineProperty(y,_,{value:S,enumerable:!0,configurable:!0,writable:!0}):y[_]=S,y),q=(document.querySelector(".popup__form"),function(t,e,n){!function(t){return t.some((function(t){return!t.validity.valid}))}(t)?(e.classList.remove(n.inactiveSubmitButtonClass),e.removeAttribute("disabled",!0)):(e.classList.add(n.inactiveSubmitButtonClass),e.setAttribute("disabled",!0))});function C(t){t.reset()}var k=document.querySelector(".profile__author"),E=document.querySelector(".profile__stilus"),L=document.querySelector(".profile__about-the-author"),j=document.querySelector(".profile__add-button"),g=document.querySelector(".profile__avatar"),x=document.querySelector("#userInfo"),P=document.querySelector("#userForm"),A=document.querySelector("#username"),T=document.querySelector("#userjob"),B=document.querySelector("#userInfoClose"),O=document.querySelector("#userSubmitButton"),z=document.querySelector("#cardInfo"),D=document.querySelector("#cardInfoSubmit"),w=document.querySelector("#mesto"),I=document.querySelector("#mestoHref"),H=document.querySelector("#cardInfoClose"),N=document.querySelector("#cardSubmitButton"),J=document.querySelector(".profile__container-avatar "),F=document.querySelector("#editAvatar"),M=document.querySelector("#avatarClose"),Q=document.querySelector("#formAvatarEdit"),U=document.querySelector("#avatarHref"),G=document.querySelector("#avatarSubmitButton"),K=document.querySelector("#deleteCard"),R=document.querySelector("#cardDeleteFormClose");E.addEventListener("click",(function(){A.value=k.textContent,T.value=L.textContent,o(x)})),B.addEventListener("click",(function(){r(x)})),J.addEventListener("click",(function(){o(F)})),M.addEventListener("click",(function(){r(F),C(Q)})),R.addEventListener("click",(function(){r(K)})),Q.addEventListener("submit",(function(t){var e;t.preventDefault(),G.textContent="Сохранение...",(e=U.value,fetch("".concat(a,"/users/me/avatar "),{method:"PATCH",headers:{authorization:u,"Content-Type":"application/json"},body:JSON.stringify({avatar:e})}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}))).then((function(){i().then((function(t){g.src=t.avatar})),r(F),C(Q)})).catch((function(t){console.log(t)})).finally((function(){G.textContent="Сохранить"}))})),P.addEventListener("submit",(function(t){var e,n;t.preventDefault(),O.textContent="Сохранение...",(e=A.value,n=T.value,fetch("".concat(a,"/users/me "),{method:"PATCH",headers:{authorization:u,"Content-Type":"application/json"},body:JSON.stringify({name:e,about:n})}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}))).then((function(){i().then((function(t){k.textContent=t.name,L.textContent=t.about})),r(x)})).catch((function(t){console.log(t)})).finally((function(){O.textContent="Сохранить"}))})),j.addEventListener("click",(function(){o(z)})),H.addEventListener("click",(function(){r(z)})),D.addEventListener("submit",(function(t){var e,n;t.preventDefault(),N.textContent="Сохранение...",(e=w.value,n=I.value,fetch("".concat(a,"/cards"),{method:"POST",headers:{authorization:u,"Content-Type":"application/json"},body:JSON.stringify({name:e,link:n})}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}))).then((function(){r(z),C(D),N.classList.add(b.inactiveSubmitButtonClass),N.setAttribute("disabled",!0),v(),h()})).catch((function(t){console.log(t)})).finally((function(){N.textContent="Сохранить"}))})),i().then((function(t){k.textContent=t.name,L.textContent=t.about,g.src=t.avatar})).catch((function(t){console.log(t)})),h(),function(t){Array.from(document.querySelectorAll(t.formSelector)).forEach((function(e){e.addEventListener("submit",(function(t){t.preventDefault()})),function(t,e){var n=Array.from(t.querySelectorAll(e.inputSelector)),o=t.querySelector(e.submitButtonSelector);q(n,o,e),n.forEach((function(r){r.addEventListener("input",(function(){!function(t,e,n,o){e.validity.valid?function(t,e,n){var o=t.querySelector(".".concat(e.id,"-input-error"));e.classList.remove(n.inputErrorClass),o.classList.remove(n.errorClass),o.textContent=""}(t,e,o):function(t,e,n,o){var r=t.querySelector(".".concat(e.id,"-input-error"));e.classList.add(o.inputErrorClass),r.textContent=n,r.classList.add(o.errorClass)}(t,e,n,o)}(t,r,r.validationMessage,e),q(n,o,e)}))}))}(e,t)}))}(b)})();