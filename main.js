(()=>{"use strict";var t={d:(e,n)=>{for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};t.d({},{Q:()=>z});var e=document.querySelector("#cardOpened");function n(t){t.classList.add("popup_opened"),document.addEventListener("keydown",r)}function o(t){t.classList.remove("popup_opened"),document.removeEventListener("keydown",r)}function r(t){"Escape"===t.key&&o(document.querySelector(".popup_opened"))}document.querySelectorAll(".popup").forEach((function(t){t.addEventListener("click",(function(e){e.target.classList.contains("popup")&&o(t)}))}));var c={baseUrl:"https://nomoreparties.co/v1/plus-cohort-12",headers:{authorization:"34f1d1b4-ec71-416c-890a-2a395d08a4e1","Content-Type":"application/json"}};function a(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}var u,i=document.querySelector("#cardMesto").content,s=document.querySelector(".cards"),l=document.querySelector("#cardDeleteSubmitButton"),d=document.querySelector(".popup__image"),f=document.querySelector(".popup__image-text");function m(t,o,r,s,l,m){var p=i.cloneNode(!0),v=p.querySelector(".card__like-button"),h=p.querySelector(".card__like-counter"),_=p.querySelector(".card__text"),b=p.querySelector(".card__mask-group");return b.src=t,b.alt=o,_.textContent=o,h.textContent=r.length,function(t,e){var n=!1;return t.forEach((function(t){t._id===e&&(n=!0)})),n}(r,m)&&v.classList.add("card__like-button_active"),v.addEventListener("click",(function(){!function(t,e,n){n.classList.contains("card__like-button_active")?function(t){return fetch("".concat(c.baseUrl,"/cards/likes/").concat(t),{method:"DELETE",headers:c.headers}).then(a)}(t).then((function(t){e.textContent=t.likes.length,n.classList.remove("card__like-button_active")})).catch((function(t){console.log(t)})):function(t){return fetch("".concat(c.baseUrl,"/cards/likes/").concat(t),{method:"PUT",headers:c.headers}).then(a)}(t).then((function(t){e.textContent=t.likes.length,n.classList.add("card__like-button_active")})).catch((function(t){console.log(t)}))}(l,h,v)})),s===m?p.querySelector(".card__trash-button").addEventListener("click",(function(){u=null,n(z),(u=b.closest(".card")).id=l})):p.querySelector(".card__trash-button").classList.add("card__trash-button_hidden"),b.addEventListener("click",(function(){n(e),d.src=t,f.textContent=o,d.alt=o})),p}function p(t,e,n,o,r,c){var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"end",u=m(t,e,n,o,r,c);"start"===a?s.prepend(u):s.append(u)}var v,h,_,b=(_="popup__item_input-error",(h="inputErrorClass")in(v={formSelector:".popup__form",inputSelector:".popup__item",submitButtonSelector:".popup__submit-button",inactiveSubmitButtonClass:"popup__submit-button_inactive",inactiveButtonClass:"popup__button-close",inputErrorClass:"popup__item-error",errorClass:"popup__item-error_active"})?Object.defineProperty(v,h,{value:_,enumerable:!0,configurable:!0,writable:!0}):v[h]=_,v),y=function(t,e,n){!function(t){return t.some((function(t){return!t.validity.valid}))}(t)?(e.classList.remove(n.inactiveSubmitButtonClass),e.removeAttribute("disabled",!0)):(e.classList.add(n.inactiveSubmitButtonClass),e.setAttribute("disabled",!0))};function S(t){t.reset()}var q,C=document.querySelector(".profile__author"),E=document.querySelector(".profile__stilus"),L=document.querySelector(".profile__about-the-author"),k=document.querySelector(".profile__add-button"),x=document.querySelector(".profile__avatar"),g=document.querySelector("#userInfo"),A=document.querySelector("#userForm"),B=document.querySelector("#username"),U=document.querySelector("#userjob"),O=document.querySelector("#userSubmitButton"),P=document.querySelector("#cardInfo"),j=document.querySelector("#cardInfoSubmit"),D=document.querySelector("#mesto"),T=document.querySelector("#mestoHref"),w=document.querySelector("#cardSubmitButton"),H=document.querySelector(".profile__container-avatar "),N=document.querySelector("#editAvatar"),I=document.querySelector("#formAvatarEdit"),J=document.querySelector("#avatarHref"),M=document.querySelector("#avatarSubmitButton"),z=document.querySelector("#deleteCard");document.querySelectorAll(".popup__button-close").forEach((function(t){var e=t.closest(".popup");t.addEventListener("click",(function(){return o(e)}))})),E.addEventListener("click",(function(){B.value=C.textContent,U.value=L.textContent,O.textContent="Сохранить",n(g)})),H.addEventListener("click",(function(){M.textContent="Сохранить",S(I),n(N)})),I.addEventListener("submit",(function(t){var e;t.preventDefault(),M.textContent="Сохранение...",(e=J.value,fetch("".concat(c.baseUrl,"/users/me/avatar "),{method:"PATCH",headers:c.headers,body:JSON.stringify({avatar:e})}).then(a)).then((function(t){x.src=t.avatar,o(N),M.classList.add("popup__submit-button_inactive"),avatarSubmitButtont.setAttribute("disabled",!0)})).catch((function(t){console.log(t)})).finally((function(){M.textContent="Сохранить"}))})),A.addEventListener("submit",(function(t){var e,n;t.preventDefault(),O.textContent="Сохранение...",(e=B.value,n=U.value,fetch("".concat(c.baseUrl,"/users/me "),{method:"PATCH",headers:c.headers,body:JSON.stringify({name:e,about:n})}).then(a)).then((function(t){C.textContent=t.name,L.textContent=t.about,o(g)})).catch((function(t){console.log(t)})).finally((function(){O.textContent="Сохранить"}))})),k.addEventListener("click",(function(){S(j),n(P)})),j.addEventListener("submit",(function(t){var e,n;t.preventDefault(),w.textContent="Сохранение...",(e=D.value,n=T.value,fetch("".concat(c.baseUrl,"/cards"),{method:"POST",headers:c.headers,body:JSON.stringify({name:e,link:n})}).then(a)).then((function(t){o(P),w.classList.add(b.inactiveSubmitButtonClass),w.setAttribute("disabled",!0),p(t.link,t.name,t.likes,t.owner._id,t._id,q,"start")})).catch((function(t){console.log(t)})).finally((function(){w.textContent="Сохранить"}))})),z.addEventListener("submit",(function(){var t,e;t=u,l.textContent="Удаление...",(e=t.id,fetch("".concat(c.baseUrl,"/cards/").concat(e),{method:"DELETE",headers:c.headers}).then(a)).then((function(){o(z),t.remove()})).catch((function(t){console.log(t)})).finally((function(){l.textContent="Да"}))})),fetch("".concat(c.baseUrl,"/users/me"),{headers:c.headers}).then(a).then((function(t){C.textContent=t.name,L.textContent=t.about,x.src=t.avatar,function(t){fetch("".concat(c.baseUrl,"/cards"),{headers:c.headers}).then(a).then((function(e){e.forEach((function(e){p(e.link,e.name,e.likes,e.owner._id,e._id,t)}))})).catch((function(t){console.log(t)}))}(q=t._id)})).catch((function(t){console.log(t)})),function(t){Array.from(document.querySelectorAll(t.formSelector)).forEach((function(e){e.addEventListener("submit",(function(t){t.preventDefault()})),function(t,e){var n=Array.from(t.querySelectorAll(e.inputSelector)),o=t.querySelector(e.submitButtonSelector);y(n,o,e),n.forEach((function(r){r.addEventListener("input",(function(){!function(t,e,n,o){e.validity.valid?function(t,e,n){var o=t.querySelector(".".concat(e.id,"-input-error"));e.classList.remove(n.inputErrorClass),o.classList.remove(n.errorClass),o.textContent=""}(t,e,o):function(t,e,n,o){var r=t.querySelector(".".concat(e.id,"-input-error"));e.classList.add(o.inputErrorClass),r.textContent=n,r.classList.add(o.errorClass)}(t,e,n,o)}(t,r,r.validationMessage,e),y(n,o,e)}))}))}(e,t)}))}(b)})();