(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{QC:()=>R});var t=document.querySelector("#cardOpened"),n=document.querySelector("#imageClose");function o(e){e.classList.add("popup_opened"),document.addEventListener("keydown",c)}function r(e){e.classList.remove("popup_opened"),document.addEventListener("keydown",c)}function c(e){"Escape"===e.key&&r(document.querySelector(".popup_opened"))}document.querySelectorAll(".popup").forEach((function(e){e.addEventListener("click",(function(t){t.target.classList.contains("popup")&&r(e)}))})),n.addEventListener("click",(function(){r(t)}));var a={baseUrl:"https://nomoreparties.co/v1/plus-cohort-12",headers:{authorization:"34f1d1b4-ec71-416c-890a-2a395d08a4e1","Content-Type":"application/json"}};function u(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}function i(){return fetch("".concat(a.baseUrl,"/users/me"),{headers:a.headers}).then(u)}var s,l=document.querySelector("#cardMesto").content,d=document.querySelector(".cards"),f=document.querySelector("#cardDeleteSubmitButton"),m=document.querySelector(".popup__image"),p=document.querySelector(".popup__image-text");function v(e,n,r,c,i,d){var v=l.cloneNode(!0),h=v.querySelector(".card__like-button"),_=v.querySelector(".card__like-counter"),y=v.querySelector(".card__text"),S=v.querySelector(".card__mask-group");return S.id=i,S.src=e,S.alt=n,y.textContent=n,_.textContent=r.length,function(e,t){var n=!1;return e.forEach((function(e){e._id===t&&(n=!0)})),n}(r,d)&&h.classList.add("card__like-button_active"),h.addEventListener("click",(function(){!function(e,t,n){n.classList.contains("card__like-button_active")?function(e){return fetch("".concat(a.baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:a.headers}).then(u)}(e).then((function(e){t.textContent=e.likes.length,n.classList.remove("card__like-button_active")})).catch((function(e){console.log(e)})):function(e){return fetch("".concat(a.baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:a.headers}).then(u)}(e).then((function(e){t.textContent=e.likes.length,n.classList.add("card__like-button_active")})).catch((function(e){console.log(e)}))}(i,_,h)})),c===d?v.querySelector(".card__trash-button").addEventListener("click",(function(){s=null,f.textContent="Да",o(R),s=i})):v.querySelector(".card__trash-button").classList.add("card__trash-button_hidden"),v.querySelector(".card__mask-group").addEventListener("click",(function(r){o(t),m.src=e,p.textContent=n,m.alt=n})),v}function h(e,t,n,o,r,c){var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"end",u=v(e,t,n,o,r,c);"start"===a?d.prepend(u):d.append(u)}var _,y,S,b=(S="popup__item_input-error",(y="inputErrorClass")in(_={formSelector:".popup__form",inputSelector:".popup__item",submitButtonSelector:".popup__submit-button",inactiveSubmitButtonClass:"popup__submit-button_inactive",inactiveButtonClass:"popup__button-close",inputErrorClass:"popup__item-error",errorClass:"popup__item-error_active"})?Object.defineProperty(_,y,{value:S,enumerable:!0,configurable:!0,writable:!0}):_[y]=S,_),q=(document.querySelector(".popup__form"),function(e,t,n){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.classList.remove(n.inactiveSubmitButtonClass),t.removeAttribute("disabled",!0)):(t.classList.add(n.inactiveSubmitButtonClass),t.setAttribute("disabled",!0))});function C(e){e.reset()}var E,L=document.querySelector(".profile__author"),k=document.querySelector(".profile__stilus"),x=document.querySelector(".profile__about-the-author"),g=document.querySelector(".profile__add-button"),A=document.querySelector(".profile__avatar"),B=document.querySelector("#userInfo"),U=document.querySelector("#userForm"),O=document.querySelector("#username"),D=document.querySelector("#userjob"),P=document.querySelector("#userInfoClose"),j=document.querySelector("#userSubmitButton"),T=document.querySelector("#cardInfo"),w=document.querySelector("#cardInfoSubmit"),I=document.querySelector("#mesto"),H=document.querySelector("#mestoHref"),N=document.querySelector("#cardInfoClose"),J=document.querySelector("#cardSubmitButton"),F=document.querySelector(".profile__container-avatar "),M=document.querySelector("#editAvatar"),z=document.querySelector("#avatarClose"),Q=document.querySelector("#formAvatarEdit"),G=document.querySelector("#avatarHref"),K=document.querySelector("#avatarSubmitButton"),R=document.querySelector("#deleteCard"),V=document.querySelector("#cardDeleteFormClose");k.addEventListener("click",(function(){O.value=L.textContent,D.value=x.textContent,j.textContent="Сохранить",o(B)})),P.addEventListener("click",(function(){r(B)})),F.addEventListener("click",(function(){K.textContent="Сохранить",o(M)})),z.addEventListener("click",(function(){r(M),C(Q)})),V.addEventListener("click",(function(){r(R)})),Q.addEventListener("submit",(function(e){var t;e.preventDefault(),K.textContent="Сохранение...",(t=G.value,fetch("".concat(a.baseUrl,"/users/me/avatar "),{method:"PATCH",headers:a.headers,body:JSON.stringify({avatar:t})}).then(u)).then((function(){i().then((function(e){A.src=e.avatar})),r(M),C(Q)})).catch((function(e){console.log(e)})).finally((function(){K.textContent="Сохранено"}))})),U.addEventListener("submit",(function(e){var t,n;e.preventDefault(),j.textContent="Сохранение...",(t=O.value,n=D.value,fetch("".concat(a.baseUrl,"/users/me "),{method:"PATCH",headers:a.headers,body:JSON.stringify({name:t,about:n})}).then(u)).then((function(){i().then((function(e){L.textContent=e.name,x.textContent=e.about})),r(B)})).catch((function(e){console.log(e)})).finally((function(){j.textContent="Сохранено"}))})),g.addEventListener("click",(function(){o(T)})),N.addEventListener("click",(function(){r(T)})),w.addEventListener("submit",(function(e){var t,n;e.preventDefault(),J.textContent="Сохранение...",(t=I.value,n=H.value,fetch("".concat(a.baseUrl,"/cards"),{method:"POST",headers:a.headers,body:JSON.stringify({name:t,link:n})}).then(u)).then((function(e){r(T),C(w),J.classList.add(b.inactiveSubmitButtonClass),J.setAttribute("disabled",!0),h(e.link,e.name,e.likes,e.owner._id,e._id,E,"start")})).catch((function(e){console.log(e)})).finally((function(){J.textContent="Сохранено"}))})),R.addEventListener("submit",(function(){var e,t;e=s,f.textContent="Удаление...",(t=e,fetch("".concat(a.baseUrl,"/cards/").concat(t),{method:"DELETE",headers:a.headers}).then(u)).then((function(){r(R),document.getElementById(e).parentElement.remove()})).catch((function(e){console.log(e)})).finally((function(){f.textContent="Удалено"}))})),i().then((function(e){L.textContent=e.name,x.textContent=e.about,A.src=e.avatar,function(e){fetch("".concat(a.baseUrl,"/cards"),{headers:a.headers}).then(u).then((function(t){t.forEach((function(t){h(t.link,t.name,t.likes,t.owner._id,t._id,e)}))})).catch((function(e){console.log(e)}))}(E=e._id)})).catch((function(e){console.log(e)})),function(e){Array.from(document.querySelectorAll(e.formSelector)).forEach((function(t){t.addEventListener("submit",(function(e){e.preventDefault()})),function(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),o=e.querySelector(t.submitButtonSelector);q(n,o,t),n.forEach((function(r){r.addEventListener("input",(function(){!function(e,t,n,o){t.validity.valid?function(e,t,n){var o=e.querySelector(".".concat(t.id,"-input-error"));t.classList.remove(n.inputErrorClass),o.classList.remove(n.errorClass),o.textContent=""}(e,t,o):function(e,t,n,o){var r=e.querySelector(".".concat(t.id,"-input-error"));t.classList.add(o.inputErrorClass),r.textContent=n,r.classList.add(o.errorClass)}(e,t,n,o)}(e,r,r.validationMessage,t),q(n,o,t)}))}))}(t,e)}))}(b)})();