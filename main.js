(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{Q:()=>z});var t=document.querySelector("#cardOpened"),n=document.querySelector("#imageClose");function o(e){e.classList.add("popup_opened"),document.addEventListener("keydown",c)}function r(e){e.classList.remove("popup_opened"),document.removeEventListener("keydown",c)}function c(e){"Escape"===e.key&&r(document.querySelector(".popup_opened"))}document.querySelectorAll(".popup").forEach((function(e){e.addEventListener("click",(function(t){t.target.classList.contains("popup")&&r(e)}))})),n.addEventListener("click",(function(){r(t)}));var a={baseUrl:"https://nomoreparties.co/v1/plus-cohort-12",headers:{authorization:"34f1d1b4-ec71-416c-890a-2a395d08a4e1","Content-Type":"application/json"}};function u(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}var i,s=document.querySelector("#cardMesto").content,l=document.querySelector(".cards"),d=document.querySelector("#cardDeleteSubmitButton"),f=document.querySelector(".popup__image"),m=document.querySelector(".popup__image-text");function p(e,n,r,c,l,d){var p=s.cloneNode(!0),v=p.querySelector(".card__like-button"),h=p.querySelector(".card__like-counter"),_=p.querySelector(".card__text"),y=p.querySelector(".card__mask-group");return y.src=e,y.alt=n,_.textContent=n,h.textContent=r.length,function(e,t){var n=!1;return e.forEach((function(e){e._id===t&&(n=!0)})),n}(r,d)&&v.classList.add("card__like-button_active"),v.addEventListener("click",(function(){!function(e,t,n){n.classList.contains("card__like-button_active")?function(e){return fetch("".concat(a.baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:a.headers}).then(u)}(e).then((function(e){t.textContent=e.likes.length,n.classList.remove("card__like-button_active")})).catch((function(e){console.log(e)})):function(e){return fetch("".concat(a.baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:a.headers}).then(u)}(e).then((function(e){t.textContent=e.likes.length,n.classList.add("card__like-button_active")})).catch((function(e){console.log(e)}))}(l,h,v)})),c===d?p.querySelector(".card__trash-button").addEventListener("click",(function(){i=null,o(z),(i=y.closest(".card")).id=l})):p.querySelector(".card__trash-button").classList.add("card__trash-button_hidden"),y.addEventListener("click",(function(){o(t),f.src=e,m.textContent=n,f.alt=n})),p}function v(e,t,n,o,r,c){var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"end",u=p(e,t,n,o,r,c);"start"===a?l.prepend(u):l.append(u)}var h,_,y,b=(y="popup__item_input-error",(_="inputErrorClass")in(h={formSelector:".popup__form",inputSelector:".popup__item",submitButtonSelector:".popup__submit-button",inactiveSubmitButtonClass:"popup__submit-button_inactive",inactiveButtonClass:"popup__button-close",inputErrorClass:"popup__item-error",errorClass:"popup__item-error_active"})?Object.defineProperty(h,_,{value:y,enumerable:!0,configurable:!0,writable:!0}):h[_]=y,h),S=function(e,t,n){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.classList.remove(n.inactiveSubmitButtonClass),t.removeAttribute("disabled",!0)):(t.classList.add(n.inactiveSubmitButtonClass),t.setAttribute("disabled",!0))};function q(e){e.reset()}var C,E=document.querySelector(".profile__author"),L=document.querySelector(".profile__stilus"),k=document.querySelector(".profile__about-the-author"),x=document.querySelector(".profile__add-button"),g=document.querySelector(".profile__avatar"),A=document.querySelector("#userInfo"),B=document.querySelector("#userForm"),U=document.querySelector("#username"),O=document.querySelector("#userjob"),D=document.querySelector("#userSubmitButton"),P=document.querySelector("#cardInfo"),j=document.querySelector("#cardInfoSubmit"),T=document.querySelector("#mesto"),w=document.querySelector("#mestoHref"),H=document.querySelector("#cardSubmitButton"),N=document.querySelector(".profile__container-avatar "),I=document.querySelector("#editAvatar"),J=document.querySelector("#formAvatarEdit"),F=document.querySelector("#avatarHref"),M=document.querySelector("#avatarSubmitButton"),z=document.querySelector("#deleteCard"),Q=document.querySelector("#cardDeleteFormClose");document.querySelectorAll(".popup__button-close").forEach((function(e){var t=e.closest(".popup");e.addEventListener("click",(function(){return r(t)}))})),L.addEventListener("click",(function(){U.value=E.textContent,O.value=k.textContent,D.textContent="Сохранить",o(A)})),N.addEventListener("click",(function(){M.textContent="Сохранить",q(J),o(I)})),Q.addEventListener("click",(function(){r(z)})),J.addEventListener("submit",(function(e){var t;e.preventDefault(),M.textContent="Сохранение...",(t=F.value,fetch("".concat(a.baseUrl,"/users/me/avatar "),{method:"PATCH",headers:a.headers,body:JSON.stringify({avatar:t})}).then(u)).then((function(e){g.src=e.avatar,r(I)})).catch((function(e){console.log(e)})).finally((function(){M.textContent="Сохранить"}))})),B.addEventListener("submit",(function(e){var t,n;e.preventDefault(),D.textContent="Сохранение...",(t=U.value,n=O.value,fetch("".concat(a.baseUrl,"/users/me "),{method:"PATCH",headers:a.headers,body:JSON.stringify({name:t,about:n})}).then(u)).then((function(e){E.textContent=e.name,k.textContent=e.about,r(A)})).catch((function(e){console.log(e)})).finally((function(){D.textContent="Сохранить"}))})),x.addEventListener("click",(function(){q(j),o(P)})),j.addEventListener("submit",(function(e){var t,n;e.preventDefault(),H.textContent="Сохранение...",(t=T.value,n=w.value,fetch("".concat(a.baseUrl,"/cards"),{method:"POST",headers:a.headers,body:JSON.stringify({name:t,link:n})}).then(u)).then((function(e){r(P),H.classList.add(b.inactiveSubmitButtonClass),H.setAttribute("disabled",!0),v(e.link,e.name,e.likes,e.owner._id,e._id,C,"start")})).catch((function(e){console.log(e)})).finally((function(){H.textContent="Сохранить"}))})),z.addEventListener("submit",(function(){var e,t;e=i,d.textContent="Удаление...",(t=e.id,fetch("".concat(a.baseUrl,"/cards/").concat(t),{method:"DELETE",headers:a.headers}).then(u)).then((function(){r(z),e.remove()})).catch((function(e){console.log(e)})).finally((function(){d.textContent="Да"}))})),fetch("".concat(a.baseUrl,"/users/me"),{headers:a.headers}).then(u).then((function(e){E.textContent=e.name,k.textContent=e.about,g.src=e.avatar,function(e){fetch("".concat(a.baseUrl,"/cards"),{headers:a.headers}).then(u).then((function(t){t.forEach((function(t){v(t.link,t.name,t.likes,t.owner._id,t._id,e)}))})).catch((function(e){console.log(e)}))}(C=e._id)})).catch((function(e){console.log(e)})),function(e){Array.from(document.querySelectorAll(e.formSelector)).forEach((function(t){t.addEventListener("submit",(function(e){e.preventDefault()})),function(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),o=e.querySelector(t.submitButtonSelector);S(n,o,t),n.forEach((function(r){r.addEventListener("input",(function(){!function(e,t,n,o){t.validity.valid?function(e,t,n){var o=e.querySelector(".".concat(t.id,"-input-error"));t.classList.remove(n.inputErrorClass),o.classList.remove(n.errorClass),o.textContent=""}(e,t,o):function(e,t,n,o){var r=e.querySelector(".".concat(t.id,"-input-error"));t.classList.add(o.inputErrorClass),r.textContent=n,r.classList.add(o.errorClass)}(e,t,n,o)}(e,r,r.validationMessage,t),S(n,o,t)}))}))}(t,e)}))}(b)})();