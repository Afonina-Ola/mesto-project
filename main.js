(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{Q:()=>z});var t=document.querySelector("#cardOpened");function n(e){e.classList.add("popup_opened"),document.addEventListener("keydown",r)}function o(e){e.classList.remove("popup_opened"),document.removeEventListener("keydown",r)}function r(e){"Escape"===e.key&&o(document.querySelector(".popup_opened"))}document.querySelectorAll(".popup").forEach((function(e){e.addEventListener("click",(function(t){t.target.classList.contains("popup")&&o(e)}))}));var c={baseUrl:"https://nomoreparties.co/v1/plus-cohort-12",headers:{authorization:"34f1d1b4-ec71-416c-890a-2a395d08a4e1","Content-Type":"application/json"}};function a(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}var u,i=document.querySelector("#cardMesto").content,s=document.querySelector(".cards"),l=document.querySelector("#cardDeleteSubmitButton"),d=document.querySelector(".popup__image"),f=document.querySelector(".popup__image-text");function m(e,o,r,s,l,m){var p=i.cloneNode(!0),v=p.querySelector(".card__like-button"),h=p.querySelector(".card__like-counter"),_=p.querySelector(".card__text"),b=p.querySelector(".card__mask-group");return b.src=e,b.alt=o,_.textContent=o,h.textContent=r.length,function(e,t){var n=!1;return e.forEach((function(e){e._id===t&&(n=!0)})),n}(r,m)&&v.classList.add("card__like-button_active"),v.addEventListener("click",(function(){!function(e,t,n){n.classList.contains("card__like-button_active")?function(e){return fetch("".concat(c.baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:c.headers}).then(a)}(e).then((function(e){t.textContent=e.likes.length,n.classList.remove("card__like-button_active")})).catch((function(e){console.log(e)})):function(e){return fetch("".concat(c.baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:c.headers}).then(a)}(e).then((function(e){t.textContent=e.likes.length,n.classList.add("card__like-button_active")})).catch((function(e){console.log(e)}))}(l,h,v)})),s===m?p.querySelector(".card__trash-button").addEventListener("click",(function(){u=null,n(z),(u=b.closest(".card")).id=l})):p.querySelector(".card__trash-button").classList.add("card__trash-button_hidden"),b.addEventListener("click",(function(){n(t),d.src=e,f.textContent=o,d.alt=o})),p}function p(e,t,n,o,r,c){var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"end",u=m(e,t,n,o,r,c);"start"===a?s.prepend(u):s.append(u)}var v,h,_,b=(_="popup__item_input-error",(h="inputErrorClass")in(v={formSelector:".popup__form",inputSelector:".popup__item",submitButtonSelector:".popup__submit-button",inactiveSubmitButtonClass:"popup__submit-button_inactive",inactiveButtonClass:"popup__button-close",inputErrorClass:"popup__item-error",errorClass:"popup__item-error_active"})?Object.defineProperty(v,h,{value:_,enumerable:!0,configurable:!0,writable:!0}):v[h]=_,v),y=function(e,t,n){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.classList.remove(n.inactiveSubmitButtonClass),t.removeAttribute("disabled",!0)):(t.classList.add(n.inactiveSubmitButtonClass),t.setAttribute("disabled",!0))};function S(e){e.reset()}var q,C=document.querySelector(".profile__author"),E=document.querySelector(".profile__stilus"),L=document.querySelector(".profile__about-the-author"),k=document.querySelector(".profile__add-button"),x=document.querySelector(".profile__avatar"),g=document.querySelector("#userInfo"),A=document.querySelector("#userForm"),B=document.querySelector("#username"),U=document.querySelector("#userjob"),O=document.querySelector("#userSubmitButton"),P=document.querySelector("#cardInfo"),j=document.querySelector("#cardInfoSubmit"),D=document.querySelector("#mesto"),T=document.querySelector("#mestoHref"),w=document.querySelector("#cardSubmitButton"),H=document.querySelector(".profile__container-avatar "),N=document.querySelector("#editAvatar"),I=document.querySelector("#formAvatarEdit"),J=document.querySelector("#avatarHref"),M=document.querySelector("#avatarSubmitButton"),z=document.querySelector("#deleteCard");document.querySelectorAll(".popup__button-close").forEach((function(e){var t=e.closest(".popup");e.addEventListener("click",(function(){return o(t)}))})),E.addEventListener("click",(function(){B.value=C.textContent,U.value=L.textContent,O.textContent="Сохранить",n(g)})),H.addEventListener("click",(function(){M.textContent="Сохранить",S(I),n(N)})),I.addEventListener("submit",(function(e){var t;e.preventDefault(),M.textContent="Сохранение...",(t=J.value,fetch("".concat(c.baseUrl,"/users/me/avatar "),{method:"PATCH",headers:c.headers,body:JSON.stringify({avatar:t})}).then(a)).then((function(e){x.src=e.avatar,o(N),M.classList.add("popup__submit-button_inactive"),M.setAttribute("disabled",!0)})).catch((function(e){console.log(e)})).finally((function(){M.textContent="Сохранить"}))})),A.addEventListener("submit",(function(e){var t,n;e.preventDefault(),O.textContent="Сохранение...",(t=B.value,n=U.value,fetch("".concat(c.baseUrl,"/users/me "),{method:"PATCH",headers:c.headers,body:JSON.stringify({name:t,about:n})}).then(a)).then((function(e){C.textContent=e.name,L.textContent=e.about,o(g)})).catch((function(e){console.log(e)})).finally((function(){O.textContent="Сохранить"}))})),k.addEventListener("click",(function(){S(j),n(P)})),j.addEventListener("submit",(function(e){var t,n;e.preventDefault(),w.textContent="Сохранение...",(t=D.value,n=T.value,fetch("".concat(c.baseUrl,"/cards"),{method:"POST",headers:c.headers,body:JSON.stringify({name:t,link:n})}).then(a)).then((function(e){o(P),w.classList.add(b.inactiveSubmitButtonClass),w.setAttribute("disabled",!0),p(e.link,e.name,e.likes,e.owner._id,e._id,q,"start")})).catch((function(e){console.log(e)})).finally((function(){w.textContent="Сохранить"}))})),z.addEventListener("submit",(function(){var e,t;e=u,l.textContent="Удаление...",(t=e.id,fetch("".concat(c.baseUrl,"/cards/").concat(t),{method:"DELETE",headers:c.headers}).then(a)).then((function(){o(z),e.remove()})).catch((function(e){console.log(e)})).finally((function(){l.textContent="Да"}))})),fetch("".concat(c.baseUrl,"/users/me"),{headers:c.headers}).then(a).then((function(e){C.textContent=e.name,L.textContent=e.about,x.src=e.avatar,function(e){fetch("".concat(c.baseUrl,"/cards"),{headers:c.headers}).then(a).then((function(t){t.forEach((function(t){p(t.link,t.name,t.likes,t.owner._id,t._id,e)}))})).catch((function(e){console.log(e)}))}(q=e._id)})).catch((function(e){console.log(e)})),function(e){Array.from(document.querySelectorAll(e.formSelector)).forEach((function(t){t.addEventListener("submit",(function(e){e.preventDefault()})),function(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),o=e.querySelector(t.submitButtonSelector);y(n,o,t),n.forEach((function(r){r.addEventListener("input",(function(){!function(e,t,n,o){t.validity.valid?function(e,t,n){var o=e.querySelector(".".concat(t.id,"-input-error"));t.classList.remove(n.inputErrorClass),o.classList.remove(n.errorClass),o.textContent=""}(e,t,o):function(e,t,n,o){var r=e.querySelector(".".concat(t.id,"-input-error"));t.classList.add(o.inputErrorClass),r.textContent=n,r.classList.add(o.errorClass)}(e,t,n,o)}(e,r,r.validationMessage,t),y(n,o,t)}))}))}(t,e)}))}(b)})();